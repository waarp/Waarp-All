<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="fr"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>FtpCommandCode.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">Waarp Gateway Ftp</a> &gt; <a href="../index.html" class="el_bundle">WaarpFtp-Core</a> &gt; <a href="index.source.html" class="el_package">org.waarp.ftp.core.command</a> &gt; <span class="el_source">FtpCommandCode.java</span></div><h1>FtpCommandCode.java</h1><pre class="source lang-java linenums">/*
 * This file is part of Waarp Project (named also Waarp or GG).
 *
 *  Copyright (c) 2019, Waarp SAS, and individual contributors by the @author
 *  tags. See the COPYRIGHT.txt in the distribution for a full listing of
 * individual contributors.
 *
 *  All Waarp Project is free software: you can redistribute it and/or
 * modify it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or (at your
 * option) any later version.
 *
 * Waarp is distributed in the hope that it will be useful, but WITHOUT ANY
 * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
 * A PARTICULAR PURPOSE. See the GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License along with
 * Waarp . If not, see &lt;http://www.gnu.org/licenses/&gt;.
 */
package org.waarp.ftp.core.command;

import org.waarp.ftp.core.command.internal.ConnectionCommand;
import org.waarp.ftp.core.command.internal.IncorrectCommand;
import org.waarp.ftp.core.command.internal.UnimplementedCommand;
import org.waarp.ftp.core.command.internal.UnknownCommand;
import org.waarp.ftp.core.file.FtpFile;
import org.waarp.ftp.core.session.FtpSession;

/**
 * This class must reassemble all the commands that could be implemented. The
 * comment says the object of the
 * command and the kind of returned codes that could follow this command.&lt;br&gt;
 * &lt;br&gt;
 * Command structure:&lt;br&gt;
 * Main class&lt;br&gt;
 * Previous Valid Command (null means all are valid)&lt;br&gt;
 * Next Valid Commands (none means all are valid)&lt;br&gt;
 */
<span class="fc" id="L39">public enum FtpCommandCode {</span>
  // XXX CONNECTION
  /**
   * Command to simulate the beginning of a connection in order to force the
   * authentication step.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 120-&gt;220&lt;br&gt;
   * 220&lt;br&gt;
   * 421&lt;br&gt;
   */
<span class="fc" id="L50">  Connection(ConnectionCommand.class, null,</span>
             org.waarp.ftp.core.command.access.USER.class,
             org.waarp.ftp.core.command.rfc2389.FEAT.class,
             org.waarp.ftp.core.command.rfc2389.OPTS.class),
  // XXX ACCESS CONTROL COMMAND
  /**
   * The argument field is a Telnet string identifying the user. The user
   * identification is that which is
   * required by the server for access to its file system. This command will
   * normally be the first command
   * transmitted by the user after the control connections are made (some
   * servers may require this). Additional
   * identification information in the form of a password and/or an account
   * command may also be required by some
   * servers. Servers may allow a new USER command to be entered at any point
   * in
   * order to change the access
   * control and/or accounting information. This has the effect of flushing
   * any
   * user, password, and account
   * information already supplied and beginning the login sequence again. All
   * transfer parameters are unchanged
   * and any file transfer in progress is completed under the old access
   * control
   * parameters.&lt;br&gt;
   * &lt;p&gt;
   * 230&lt;br&gt;
   * 530&lt;br&gt;
   * 500, 501, 421&lt;br&gt;
   * 331, 332&lt;br&gt;
   */
<span class="fc" id="L81">  USER(org.waarp.ftp.core.command.access.USER.class, ConnectionCommand.class),</span>
  /**
   * The argument field is a Telnet string specifying the user's password.
   * This
   * command must be immediately
   * preceded by the user name command, and, for some sites, completes the
   * user's identification for access
   * control. Since password information is quite sensitive, it is desirable
   * in
   * general to &quot;mask&quot; it or suppress
   * typeout. It appears that the server has no foolproof way to achieve
   * this.
   * It is therefore the
   * responsibility of the user-FTP process to hide the sensitive password
   * information.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 230&lt;br&gt;
   * 202&lt;br&gt;
   * 530&lt;br&gt;
   * 500, 501, 503, 421&lt;br&gt;
   * 332&lt;br&gt;
   */
<span class="fc" id="L104">  PASS(org.waarp.ftp.core.command.access.PASS.class, null),</span>
  /**
   * The argument field is a Telnet string identifying the user's account.
   * The
   * command is not necessarily
   * related to the USER command, as some sites may require an account for
   * login
   * and others only for specific
   * access, such as storing files. In the latter case the command may arrive
   * at
   * any time.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * There are reply codes to differentiate these cases for the automation:
   * when
   * account information is required
   * for login, the response to a successful PASSword command is reply code
   * 332.
   * On the other hand, if account
   * information is NOT required for login, the reply to a successful
   * PASSword
   * command is 230; and if the
   * account information is needed for a command issued later in the
   * dialogue,
   * the server should return a 332 or
   * 532 reply depending on whether it stores (pending receipt of the ACCounT
   * command) or discards the command,
   * respectively.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 230&lt;br&gt;
   * 202&lt;br&gt;
   * 530&lt;br&gt;
   * 500, 501, 503, 421&lt;br&gt;
   */
<span class="fc" id="L139">  ACCT(org.waarp.ftp.core.command.access.ACCT.class, null),</span>
  /**
   * This command allows the user to work with a different directory or
   * dataset
   * for file storage or retrieval
   * without altering his login or accounting information. Transfer
   * parameters
   * are similarly unchanged. The
   * argument is a pathname specifying a directory or other system dependent
   * file group designator.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 250&lt;br&gt;
   * 500, 501, 502, 421, 530, 550&lt;br&gt;
   */
<span class="fc" id="L154">  CWD(org.waarp.ftp.core.command.directory.CWD.class, null),</span>
  /**
   * This command is a special case of CWD, and is included to simplify the
   * implementation of programs for
   * transferring directory trees between operating systems having different
   * syntaxes for naming the parent
   * directory. The reply codes shall be identical to the reply codes of CWD.
   * See Appendix II for further
   * details.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 200&lt;br&gt;
   * 500, 501, 502, 421, 530, 550&lt;br&gt;
   */
<span class="fc" id="L168">  CDUP(org.waarp.ftp.core.command.directory.CDUP.class, null),</span>
  /**
   * This command allows the user to mount a different file system data
   * structure without altering his login or
   * accounting information. Transfer parameters are similarly unchanged. The
   * argument is a pathname specifying
   * a directory or other system dependent file group designator.&lt;br&gt;
   * &lt;br&gt;
   * As for now, this command will not be implemented, so returns 502.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 202, 250&lt;br&gt;
   * 500, 501, 502, 421, 530, 550&lt;br&gt;
   */
  // XXX 502
<span class="fc" id="L183">  SMNT(org.waarp.ftp.core.command.directory.SMNT.class, null),</span>
  /**
   * This command terminates a USER, flushing all I/O and account
   * information,
   * except to allow any transfer in
   * progress to be completed. All parameters are reset to the default
   * settings
   * and the control connection is
   * left open. This is identical to the state in which a user finds himself
   * immediately after the control
   * connection is opened. A USER command may be expected to follow.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * 120&lt;br&gt;
   * 220&lt;br&gt;
   * 220&lt;br&gt;
   * 421&lt;br&gt;
   * 500, 502&lt;br&gt;
   */
<span class="fc" id="L202">  REIN(org.waarp.ftp.core.command.access.REIN.class, null,</span>
       org.waarp.ftp.core.command.access.USER.class),
  /**
   * This command terminates a USER and if file transfer is not in progress,
   * the
   * server closes the control
   * connection. If file transfer is in progress, the connection will remain
   * open for result response and the
   * server will then close it. If the user-process is transferring files for
   * several USERs but does not wish to
   * close and then reopen connections for each, then the REIN command should
   * be
   * used instead of QUIT.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * An unexpected close on the control connection will cause the server to
   * take
   * the effective action of an
   * abort (ABOR) and a logout (QUIT).&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 221&lt;br&gt;
   * 500&lt;br&gt;
   */
<span class="fc" id="L226">  QUIT(org.waarp.ftp.core.command.access.QUIT.class, null),</span>

  // XXX TRANSFER PARAMETER COMMAND
  /**
   * The argument is a HOST-PORT specification for the data port to be used
   * in
   * data connection. There are
   * defaults for both the user and server data ports, and under normal
   * circumstances this command and its reply
   * are not needed. If this command is used, the argument is the
   * concatenation
   * of a 32-bit internet host
   * address and a 16-bit TCP port address. This address information is
   * broken
   * into 8-bit fields and the value
   * of each field is transmitted as a decimal number (in character string
   * representation). The fields are
   * separated by commas. A port command would be:&lt;br&gt;
   * &lt;br&gt;
   *
   * &lt;pre&gt;
   * PORT h1,h2,h3,h4,p1,p2
   * &lt;/pre&gt;
   * &lt;p&gt;
   * where h1 is the high order 8 bits of the internet host address.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 200&lt;br&gt;
   * 500, 501, 421, 530&lt;br&gt;
   */
<span class="fc" id="L257">  PORT(org.waarp.ftp.core.command.parameter.PORT.class, null),</span>
  /**
   * This command requests the server-DTP to &quot;listen&quot; on a data port (which is
   * not its default data port) and to
   * wait for a connection rather than initiate one upon receipt of a transfer
   * command. The response to this
   * command includes the host and port address this server is listening
   * on.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 227&lt;br&gt;
   * 500, 501, 502, 421, 530&lt;br&gt;
   */
<span class="fc" id="L271">  PASV(org.waarp.ftp.core.command.parameter.PASV.class, null),</span>
  /**
   * The argument specifies the representation type as described in the
   * Section
   * on Data Representation and
   * Storage. Several types take a second parameter. The first parameter is
   * denoted by a single Telnet
   * character, as is the second Format parameter for ASCII and EBCDIC; the
   * second parameter for local byte is a
   * decimal integer to indicate Bytesize. The parameters are separated by a
   * {@code &lt;SP&gt;} (Space,
   * ASCII code 32).&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * The following codes are assigned for type:&lt;br&gt;
   *
   * &lt;pre&gt;
   * \    /
   *                A - ASCII |    | N - Non-print
   *                          |-&amp;gt;&amp;lt;-| T - Telnet format effectors
   *                E - EBCDIC|    | C - Carriage Control (ASA)
   *                          /    \
   *                I - Image
   *                L &amp;lt;byte size&amp;gt; - Local byte Byte size
   * &lt;/pre&gt;
   * &lt;p&gt;
   * The default representation type is ASCII Non-print. If the Format
   * parameter
   * is changed, and later just the
   * first argument is changed, Format then returns to the Non-print
   * default.&lt;br&gt;
   * &lt;p&gt;
   * 200&lt;br&gt;
   * 500, 501, 504, 421, 530&lt;br&gt;
   */
<span class="fc" id="L306">  TYPE(org.waarp.ftp.core.command.parameter.TYPE.class, null),</span>
  /**
   * The argument is a single Telnet character code specifying file structure
   * described in the Section on Data
   * Representation and Storage.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * The following codes are assigned for structure:&lt;br&gt;
   *
   * &lt;pre&gt;
   * F - FtpFile (no record structure)
   *                R - Record structure
   *                P - Page structure
   * &lt;/pre&gt;
   * &lt;p&gt;
   * The default structure is FtpFile.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 200&lt;br&gt;
   * 500, 501, 504, 421, 530&lt;br&gt;
   */
<span class="fc" id="L327">  STRU(org.waarp.ftp.core.command.parameter.STRU.class, null),</span>
  /**
   * The argument is a single Telnet character code specifying the data
   * transfer
   * modes described in the Section
   * on Transmission Modes.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * The following codes are assigned for transfer modes:&lt;br&gt;
   *
   * &lt;pre&gt;
   * S - Stream
   *                B - Block
   *                C - Compressed
   * &lt;/pre&gt;
   * &lt;p&gt;
   * The default transfer mode is Stream.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 200&lt;br&gt;
   * 500, 501, 504, 421, 530&lt;br&gt;
   */
<span class="fc" id="L349">  MODE(org.waarp.ftp.core.command.parameter.MODE.class, null),</span>

  // XXX FTP SERVICE COMMAND
  /**
   * This command causes the server-DTP to transfer a copy of the file,
   * specified in the pathname, to the
   * server- or user-DTP at the other end of the data connection. The status
   * and
   * contents of the file at the
   * server site shall be unaffected.&lt;br&gt;
   * &lt;p&gt;
   * 125, 150&lt;br&gt;
   * (110)&lt;br&gt;
   * 226, 250&lt;br&gt;
   * 425, 426, 451&lt;br&gt;
   * 450, 550&lt;br&gt;
   * 500, 501, 421, 530&lt;br&gt;
   */
<span class="fc" id="L367">  RETR(org.waarp.ftp.core.command.service.RETR.class, null),</span>
  /**
   * This command causes the server-DTP to accept the data transferred via
   * the
   * data connection and to store the
   * data as a file at the server site. If the file specified in the pathname
   * exists at the server site, then
   * its contents shall be replaced by the data being transferred. A new file
   * is
   * created at the server site if
   * the file specified in the pathname does not already exist.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 125, 150&lt;br&gt;
   * (110)&lt;br&gt;
   * 226, 250&lt;br&gt;
   * 425, 426, 451, 551, 552&lt;br&gt;
   * 532, 450, 452, 553&lt;br&gt;
   * 500, 501, 421, 530&lt;br&gt;
   */
<span class="fc" id="L387">  STOR(org.waarp.ftp.core.command.service.STOR.class, null),</span>
  /**
   * This command behaves like STOR except that the resultant file is to be
   * created in the current directory
   * under a name unique to that directory. The 250 Transfer Started response
   * must include the name
   * generated.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 125, 150&lt;br&gt;
   * (110)&lt;br&gt;
   * 226, 250&lt;br&gt;
   * 425, 426, 451, 551, 552&lt;br&gt;
   * 532, 450, 452, 553&lt;br&gt;
   * 500, 501, 421, 530&lt;br&gt;
   */
<span class="fc" id="L403">  STOU(org.waarp.ftp.core.command.service.STOU.class, null),</span>
  /**
   * This command causes the server-DTP to accept the data transferred via the
   * data connection and to store the
   * data in a file at the server site. If the file specified in the pathname
   * exists at the server site, then
   * the data shall be appended to that file; otherwise the file specified in
   * the pathname shall be created at
   * the server site.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 125, 150&lt;br&gt;
   * (110)&lt;br&gt;
   * 226, 250&lt;br&gt;
   * 425, 426, 451, 551, 552&lt;br&gt;
   * 532, 450, 452, 553&lt;br&gt;
   * 500, 501, 421, 530&lt;br&gt;
   */
<span class="fc" id="L421">  APPE(org.waarp.ftp.core.command.service.APPE.class, null),</span>
  /**
   * This command may be required by some servers to reserve sufficient
   * storage
   * to accommodate the new file to
   * be transferred. The argument shall be a decimal integer representing the
   * number of bytes (using the logical
   * byte size) of storage to be reserved for the file. For files sent with
   * record or page structure a maximum
   * record or page size (in logical bytes) might also be necessary; this is
   * indicated by a decimal integer in a
   * second argument field of the command. This second argument is optional,
   * but
   * when present should be
   * separated from the first by the three Telnet characters
   * {@code &lt;SP&gt;} R {@code &lt;SP&gt;}.
   * This command shall be followed by a STORe or APPEnd command. The ALLO
   * command should be treated as a NOOP
   * (no operation) by those servers which do not require that the maximum
   * size
   * of the file be declared
   * beforehand, and those servers interested in only the maximum record or
   * page
   * size should accept a dummy
   * value in the first argument and ignore it.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 125, 150&lt;br&gt;
   * 226, 250&lt;br&gt;
   * 425, 426, 451&lt;br&gt;
   * 450&lt;br&gt;
   * 500, 501, 502, 421, 530&lt;br&gt;
   */
<span class="fc" id="L454">  ALLO(org.waarp.ftp.core.command.service.ALLO.class, null),</span>
  /**
   * The argument field represents the server marker at which file transfer
   * is
   * to be restarted. This command
   * does not cause file transfer but skips over the file to the specified
   * data
   * checkpoint. This command shall
   * be immediately followed by the appropriate FTP service command which
   * shall
   * cause file transfer to
   * resume.&lt;br&gt;
   * &lt;br&gt;
   * The current implementation allows restart only on Stream since others
   * would
   * imply to store those
   * informations somewhere (how?).&lt;br&gt;
   * &lt;br&gt;
   * However, it could be changed if necessary by modifying the {@link
   * FtpFile}
   * restartMarker method.&lt;br&gt;
   * &lt;br&gt;
   * This command will accept commands of transfer parameter following since
   * some clients do this.&lt;br&gt;
   * &lt;p&gt;
   * 500, 501, 502, 421, 530&lt;br&gt;
   * 350&lt;br&gt;
   */
<span class="fc" id="L482">  REST(org.waarp.ftp.core.command.service.REST.class, null,</span>
       org.waarp.ftp.core.command.service.RETR.class,
       org.waarp.ftp.core.command.service.STOR.class,
       org.waarp.ftp.core.command.service.STOU.class,
       org.waarp.ftp.core.command.service.APPE.class,
       org.waarp.ftp.core.command.parameter.PORT.class,
       org.waarp.ftp.core.command.parameter.PASV.class,
       org.waarp.ftp.core.command.parameter.TYPE.class,
       org.waarp.ftp.core.command.parameter.STRU.class,
       org.waarp.ftp.core.command.parameter.MODE.class),
  /**
   * This command specifies the old pathname of the file which is to be
   * renamed.
   * This command must be
   * immediately followed by a &quot;rename to&quot; RNTO command specifying the new
   * file
   * pathname.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 450, 550&lt;br&gt;
   * 500, 501, 502, 421, 530&lt;br&gt;
   * 350&lt;br&gt;
   */
<span class="fc" id="L505">  RNFR(org.waarp.ftp.core.command.service.RNFR.class, null,</span>
       org.waarp.ftp.core.command.service.RNTO.class),
  /**
   * This command specifies the new pathname of the file specified in the
   * immediately preceding &quot;rename from&quot;
   * RNFR command. Together the two commands cause a file to be renamed. &lt;br&gt;
   * &lt;p&gt;
   * 250&lt;br&gt;
   * 532, 553&lt;br&gt;
   * 500, 501, 502, 503, 421, 530&lt;br&gt;
   */
<span class="fc" id="L516">  RNTO(org.waarp.ftp.core.command.service.RNTO.class,</span>
       org.waarp.ftp.core.command.service.RNFR.class),
  /**
   * This command tells the server to abort the previous FTP service command
   * and
   * any associated transfer of
   * data. The abort command may require &quot;special action&quot;, as discussed in
   * the
   * Section on FTP Commands, to force
   * recognition by the server. No action is to be taken if the previous
   * command
   * has been completed (including
   * data transfer). The control connection is not to be closed by the
   * server,
   * but the data connection must be
   * closed.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * There are two cases for the server upon receipt of this command: (1) the
   * FTP service command was already
   * completed, or (2) the FTP service command is still in progress.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * In the first case, the server closes the data connection (if it is open)
   * and responds with a 226 reply,
   * indicating that the abort command was successfully processed.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * In the second case, the server aborts the FTP service in progress and
   * closes the data connection, returning
   * a 426 reply to indicate that the service request terminated abnormally.
   * The
   * server then sends a 226 reply,
   * indicating that the abort command was successfully processed.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 225, 226&lt;br&gt;
   * 500, 501, 502, 421&lt;br&gt;
   */
<span class="fc" id="L555">  ABOR(org.waarp.ftp.core.command.service.ABOR.class, null),</span>
  /**
   * This command causes the file specified in the pathname to be deleted at
   * the
   * server site. If an extra level
   * of protection is desired (such as the query, &quot;Do you really wish to
   * delete?&quot;), it should be provided by the
   * user-FTP process.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 250&lt;br&gt;
   * 450, 550&lt;br&gt;
   * 500, 501, 502, 421, 530&lt;br&gt;
   */
<span class="fc" id="L569">  DELE(org.waarp.ftp.core.command.service.DELE.class, null),</span>
  /**
   * This command causes the directory specified in the pathname to be
   * removed
   * as a directory (if the pathname
   * is absolute) or as a subdirectory of the current working directory (if
   * the
   * pathname is relative).&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 250&lt;br&gt;
   * 500, 501, 502, 421, 530, 550&lt;br&gt;
   */
<span class="fc" id="L582">  RMD(org.waarp.ftp.core.command.service.RMD.class, null),</span>
  /**
   * This command causes the directory specified in the pathname to be
   * created
   * as a directory (if the pathname
   * is absolute) or as a subdirectory of the current working directory (if
   * the
   * pathname is relative).&lt;br&gt;
   * &lt;p&gt;
   * 257&lt;br&gt;
   * 500, 501, 502, 421, 530, 550&lt;br&gt;
   */
<span class="fc" id="L594">  MKD(org.waarp.ftp.core.command.service.MKD.class, null),</span>
  /**
   * This command causes the name of the current working directory to be
   * returned in the reply.&lt;br&gt;
   * &lt;p&gt;
   * 257&lt;br&gt;
   * 500, 501, 502, 421, 550&lt;br&gt;
   */
<span class="fc" id="L602">  PWD(org.waarp.ftp.core.command.service.PWD.class, null),</span>
  /**
   * This command causes a list to be sent from the server to the passive
   * DTP.
   * If the pathname specifies a
   * directory or other group of files, the server should transfer a list of
   * files in the specified directory.
   * If the pathname specifies a file then the server should send current
   * information on the file. A null
   * argument implies the user's current working or default directory. The
   * data
   * transfer is over the data
   * connection in type ASCII or type EBCDIC. (The user must ensure that the
   * TYPE is appropriately ASCII or
   * EBCDIC). Since the information on a file may vary widely from system to
   * system, this information may be
   * hard to use automatically in a program, but may be quite useful to a
   * human
   * user.&lt;br&gt;
   * &lt;br&gt;
   * The option '-a' is accepted but ignored.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 125, 150&lt;br&gt;
   * 226, 250&lt;br&gt;
   * 425, 426, 451&lt;br&gt;
   * 450&lt;br&gt;
   * 500, 501, 502, 421, 530&lt;br&gt;
   */
<span class="fc" id="L631">  LIST(org.waarp.ftp.core.command.service.LIST.class, null),</span>
  /**
   * This command causes a directory listing to be sent from server to user
   * site. The pathname should specify a
   * directory or other system-specific file group descriptor; a null
   * argument
   * implies the current directory.
   * The server will return a stream of names of files and no other
   * information.
   * The data will be transferred in
   * ASCII or EBCDIC type over the data connection as valid pathname strings
   * separated by
   * {@code &lt;CRLF&gt;} or {@code &lt;NL&gt;}. (Again the user
   * must
   * ensure that the TYPE is
   * correct.) This command is intended to return information that can be
   * used
   * by a program to further process
   * the files automatically. For example, in the implementation of a
   * &quot;multiple
   * get&quot; function.&lt;br&gt;
   * &lt;br&gt;
   * The option '-l' is accepted and turns to LIST command.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 125, 150&lt;br&gt;
   * 226, 250&lt;br&gt;
   * 425, 426, 451&lt;br&gt;
   * 450&lt;br&gt;
   * 500, 501, 502, 421, 530&lt;br&gt;
   */
<span class="fc" id="L662">  NLST(org.waarp.ftp.core.command.service.NLST.class, null),</span>
  /**
   * This command is used by the server to provide services specific to his
   * system that are essential to file
   * transfer but not sufficiently universal to be included as commands in
   * the
   * protocol. The nature of these
   * services and the specification of their syntax can be stated in a reply
   * to
   * the HELP SITE command.&lt;br&gt;
   * &lt;br&gt;
   * As for now, this command will not be implemented, so returns 502.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * 200&lt;br&gt;
   * 202&lt;br&gt;
   * 500, 501, 530&lt;br&gt;
   */
<span class="fc" id="L680">  SITE(org.waarp.ftp.core.command.info.SITE.class, null),</span>
  /**
   * This command is used to find out the type of operating system at the
   * server. The reply shall have as its
   * first word one of the system names listed in the current version of the
   * Assigned Numbers document.&lt;br&gt;
   * &lt;br&gt;
   * Returns &quot;UNIX Type: L8&quot;.&lt;br&gt;
   * &lt;p&gt;
   * 215&lt;br&gt;
   * 500, 501, 502, 421&lt;br&gt;
   */
<span class="fc" id="L692">  SYST(org.waarp.ftp.core.command.info.SYST.class, null),</span>
  /**
   * This command shall cause a status response to be sent over the control
   * connection in the form of a reply.
   * The command may be sent during a file transfer (along with the Telnet IP
   * and Synch signals--see the Section
   * on FTP Commands) in which case the server will respond with the status
   * of
   * the operation in progress, or it
   * may be sent between file transfers. In the latter case, the command may
   * have an argument field. If the
   * argument is a pathname, the command is analogous to the &quot;list&quot; command
   * except that data shall be
   * transferred over the control connection. If a partial pathname is given,
   * the server may respond with a list
   * of file names or attributes associated with that specification. If no
   * argument is given, the server should
   * return general status information about the server FTP process. This
   * should
   * include current values of all
   * transfer parameters and the status of connections.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 211, 212, 213&lt;br&gt;
   * 450&lt;br&gt;
   * 500, 501, 502, 421, 530&lt;br&gt;
   */
<span class="fc" id="L719">  STAT(org.waarp.ftp.core.command.info.STAT.class, null),</span>
  /**
   * This command shall cause the server to send helpful information
   * regarding
   * its implementation status over
   * the control connection to the user. The command may take an argument
   * (e.g.,
   * any command name) and return
   * more specific information as a response. The reply is type 211 or 214.
   * It
   * is suggested that HELP be allowed
   * before entering a USER command. The server may use this reply to specify
   * site-dependent parameters, e.g.,
   * in response to HELP SITE.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 211, 214&lt;br&gt;
   * 500, 501, 502, 421&lt;br&gt;
   */
<span class="fc" id="L738">  HELP(org.waarp.ftp.core.command.info.HELP.class, null),</span>
  /**
   * This command does not affect any parameters or previously entered
   * commands.
   * It specifies no action other
   * than that the server send an OK reply.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 200&lt;br&gt;
   * 500 421&lt;br&gt;
   */
<span class="fc" id="L749">  NOOP(org.waarp.ftp.core.command.info.NOOP.class, null),</span>

  // XXX RFC775

  /**
   * Change to a new working directory. Same as CWD&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 250&lt;br&gt;
   * 500, 501, 502, 421, 530, 550&lt;br&gt;
   */
<span class="fc" id="L760">  XCWD(org.waarp.ftp.core.command.rfc775.XCWD.class, null),</span>
  /**
   * Change to the parent of the current working directory. Same as CDUP.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 200&lt;br&gt;
   * 500, 501, 502, 421, 530, 550&lt;br&gt;
   */
<span class="fc" id="L768">  XCUP(org.waarp.ftp.core.command.rfc775.XCUP.class, null),</span>
  /**
   * Remove the directory. Same as RMD.&lt;br&gt;
   * &lt;p&gt;
   * 250&lt;br&gt;
   * 500, 501, 502, 421, 530, 550&lt;br&gt;
   */
<span class="fc" id="L775">  XRMD(org.waarp.ftp.core.command.rfc775.XRMD.class, null),</span>
  /**
   * Make a directory. Same as MKD.&lt;br&gt;
   * &lt;p&gt;
   * 257&lt;br&gt;
   * 500, 501, 502, 421, 530, 550&lt;br&gt;
   */
<span class="fc" id="L782">  XMKD(org.waarp.ftp.core.command.rfc775.XMKD.class, null),</span>
  /**
   * Print the current working directory. Same as PWD.&lt;br&gt;
   * &lt;p&gt;
   * 257&lt;br&gt;
   * 500, 501, 502, 421, 550&lt;br&gt;
   */
<span class="fc" id="L789">  XPWD(org.waarp.ftp.core.command.rfc775.XPWD.class, null),</span>

  // XXX RFC3659
  /**
   * The FTP command, MODIFICATION TIME (MDTM), can be used to determine when
   * a
   * file in the server NVFS was last
   * modified.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * The &quot;pathname&quot; specifies an object in the NVFS that may be the object of
   * a
   * RETR command. Attempts to query
   * the modification time of files that exist but are unable to be retrieved
   * may generate an error- response,
   * or can result in a positive response carrying a time-val with an
   * unspecified value, the choice being made
   * by the server-PI.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * The server-PI will respond to the MDTM command with a 213 reply giving
   * the
   * last modification time of the
   * file whose pathname was supplied, or a 550 reply if the file does not
   * exist, the modification time is
   * unavailable, or some other error has occurred.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 213&lt;br&gt;
   * 500, 501, 550&lt;br&gt;
   */
<span class="fc" id="L820">  MDTM(org.waarp.ftp.core.command.rfc3659.MDTM.class, null),</span>
  /**
   * The FTP command, SIZE OF FILE (SIZE), is used to obtain the transfer
   * size
   * of a file from the server-FTP
   * process. This is the exact number of octets (8 bit bytes) that would be
   * transmitted over the data
   * connection should that file be transmitted. This value will change
   * depending on the current STRUcture,
   * MODE, and TYPE of the data connection or of a data connection that would
   * be
   * created were one created now.
   * Thus, the result of the SIZE command is dependent on the currently
   * established STRU, MODE, and TYPE
   * parameters.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * The SIZE command returns how many octets would be transferred if the
   * file
   * were to be transferred using the
   * current transfer structure, mode, and type. This command is normally
   * used
   * in conjunction with the RESTART
   * (REST) command when STORing a file to a remote server in STREAM mode, to
   * determine the restart point. The
   * server-PI might need to read the partially transferred file, do any
   * appropriate conversion, and count the
   * number of octets that would be generated when sending the file in order
   * to
   * correctly respond to this
   * command. Estimates of the file transfer size MUST NOT be returned; only
   * precise information is
   * acceptable.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 213&lt;br&gt;
   * 500, 501, 550&lt;br&gt;
   */
<span class="fc" id="L858">  SIZE(org.waarp.ftp.core.command.rfc3659.SIZE.class, null),</span>
  /**
   * The MLSD command is intended to standardize the file and directory
   * information returned by the server-FTP
   * process. This command differs from the LIST command in that the format
   * of
   * the replies is strictly defined
   * although extensible.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * MLSD lists the contents of a directory if a directory is named, otherwise
   * a
   * 501 reply is returned. If no
   * object is named, the current directory is assumed. That will cause MLSD
   * to
   * list the contents of the current
   * directory.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 125, 150&lt;br&gt;
   * 226, 250&lt;br&gt;
   * 425, 426, 451&lt;br&gt;
   * 450&lt;br&gt;
   * 500, 501, 502, 421, 530&lt;br&gt;
   */
<span class="fc" id="L883">  MLSD(org.waarp.ftp.core.command.rfc3659.MLSD.class, null),</span>
  /**
   * The MLST command is intended to standardize the file and directory
   * information returned by the server-FTP
   * process. This command differs from the LIST command in that the format
   * of
   * the replies is strictly defined
   * although extensible.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * MLST provides data about exactly the object named on its command line,
   * and
   * no others. If no object is
   * named, the current directory is assumed. That will cause MLST to send a
   * one-line response, describing the
   * current directory itself.&lt;br&gt;
   * &lt;p&gt;
   * 125, 150&lt;br&gt;
   * 226, 250&lt;br&gt;
   * 425, 426, 451&lt;br&gt;
   * 450&lt;br&gt;
   * 500, 501, 502, 421, 530&lt;br&gt;
   */
<span class="fc" id="L906">  MLST(org.waarp.ftp.core.command.rfc3659.MLST.class, null),</span>

  // XXX RFC2389
  /**
   * The FEAT command consists solely of the word &quot;FEAT&quot;. It has no
   * parameters
   * or arguments.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * Where a server-FTP process does not support the FEAT command, it will
   * respond to the FEAT command with a
   * 500 or 502 reply. This is simply the normal &quot;unrecognized command&quot; reply
   * that any unknown command would
   * elicit. Errors in the command syntax, such as giving parameters, will
   * result in a 501 reply.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * Server-FTP processes that recognize the FEAT command, but implement no
   * extended features, and therefore
   * have nothing to report, SHOULD respond with the &quot;no-features&quot; 211 reply.
   * However, as this case is
   * practically indistinguishable from a server-FTP that does not recognize
   * the
   * FEAT command, a 500 or 502
   * reply MAY also be used. The &quot;no-features&quot; reply MUST NOT use the
   * multi-line
   * response format, exactly one
   * response line is required and permitted.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * Replies to the FEAT command MUST comply with the following syntax. Text
   * on
   * the first line of the reply is
   * free form, and not interpreted, and has no practical use, as this text
   * is
   * not expected to be revealed to
   * end users. The syntax of other reply lines is precisely defined, and if
   * present, MUST be exactly as
   * specified.&lt;br&gt;
   * &lt;br&gt;
   *
   * &lt;pre&gt;
   * feat-response   = error-response / no-features / feature-listing
   *         no-features     = &amp;quot;211&amp;quot; SP *TCHAR CRLF
   *         feature-listing = &amp;quot;211-&amp;quot; *TCHAR CRLF
   *                           1*( SP feature CRLF )
   *                           &amp;quot;211 End&amp;quot; CRLF
   *         feature         = feature-label [ SP feature-parms ]
   *         feature-label   = 1*VCHAR
   *         feature-parms   = 1*TCHAR
   * &lt;/pre&gt;
   * &lt;p&gt;
   * Note that each feature line in the feature-listing begins with a single
   * space. That space is not optional,
   * nor does it indicate general white space. This space guarantees that the
   * feature line can never be
   * misinterpreted as the end of the feature-listing, but is required even
   * where there is no possibility of
   * ambiguity.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * Each extension supported must be listed on a separate line to facilitate
   * the possible inclusion of
   * parameters supported by each extension command. The feature-label to be
   * used in the response to the FEAT
   * command will be specified as each new feature is added to the FTP
   * command
   * set. Often it will be the name of
   * a new command added, however this is not required. In fact it is not
   * required that a new feature actually
   * add a new command. Any parameters included are to be specified with the
   * definition of the command
   * concerned. That specification shall also specify how any parameters
   * present
   * are to be interpreted.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * The feature-label and feature-parms are nominally case sensitive,
   * however
   * the definitions of specific
   * labels and parameters specify the precise interpretation, and it is to
   * be
   * expected that those definitions
   * will usually specify the label and parameters in a case independent
   * manner.
   * Where this is done,
   * implementations are recommended to use upper case letters when
   * transmitting
   * the feature response.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * The FEAT command itself is not included in the list of features
   * supported,
   * support for the FEAT command is
   * indicated by return of a reply other than a 500 or 502 reply.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 211&lt;br&gt;
   * 500, 501, 550&lt;br&gt;
   */
<span class="fc" id="L1006">  FEAT(org.waarp.ftp.core.command.rfc2389.FEAT.class, null),</span>
  /**
   * The OPTS (options) command allows a user-PI to specify the desired
   * behavior
   * of a server-FTP process when
   * another FTP command (the target command) is later issued. The exact
   * behavior, and syntax, will vary with
   * the target command indicated, and will be specified with the definition
   * of
   * that command. Where no OPTS
   * behavior is defined for a particular command there are no options
   * available
   * for that command.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 200&lt;br&gt;
   * 451, 500, 501, 550&lt;br&gt;
   */
<span class="fc" id="L1024">  OPTS(org.waarp.ftp.core.command.rfc2389.OPTS.class, null),</span>

  // XXX RFC2428
  /**
   * The EPRT command allows for the specification of an extended address for
   * the data connection. The extended
   * address MUST consist of the network protocol as well as the network and
   * transport addresses. The format of
   * EPRT is:&lt;br&gt;
   * &lt;br&gt;
   *
   * &lt;pre&gt;
   * EPRT&amp;lt;space&amp;gt;&amp;lt;d&amp;gt;&amp;lt;net-prt&amp;gt;&amp;lt;d&amp;gt;&amp;lt;net-addr&amp;gt;&amp;lt;d&amp;gt;&amp;lt;tcp-port&amp;gt;&amp;lt;d&amp;gt;
   * &lt;/pre&gt;
   *
   * &lt;br&gt;
   * The EPRT command keyword MUST be followed by a single space (ASCII 32).
   * Following the space, a delimiter
   * character ({@code &lt;d&gt;}) MUST be specified. The delimiter
   * character MUST be one of the ASCII
   * characters in range 33-126 inclusive. The character &quot;|&quot; (ASCII 124) is
   * recommended unless it coincides with
   * a character needed to encode the network address.&lt;br&gt;
   * &lt;p&gt;
   * The {@code &lt;net-prt&gt;} argument MUST be an address family
   * number
   * defined by IANA in the latest
   * Assigned Numbers RFC (RFC 1700 [RP94] as of the writing of this
   * document).
   * This number indicates the
   * protocol to be used (and, implicitly, the address length). This document
   * will use two of address family
   * numbers from [RP94] as examples, according to the following table:&lt;br&gt;
   * &lt;br&gt;
   *
   * &lt;pre&gt;
   * AF Number   Protocol
   *         ---------   --------
   *         1           Internet Protocol, Version 4 [Pos81a]
   *         2           Internet Protocol, Version 6 [DH96]
   * &lt;/pre&gt;
   *
   * &lt;br&gt;
   * The {@code &lt;net-addr&gt;} is a protocol specific string
   * representation of the network address. For
   * the two address families specified above (AF Number 1 and 2), addresses
   * MUST be in the following
   * format:&lt;br&gt;
   * &lt;br&gt;
   *
   * &lt;pre&gt;
   * AF Number   Address Format      Example
   *         ---------   --------------      -------
   *         1           dotted decimal      132.235.1.2
   *         2           IPv6 string         1080::8:800:200C:417A
   *                     representations
   *                     defined in [HD96]
   * &lt;/pre&gt;
   *
   * &lt;br&gt;
   * The {@code &lt;tcp-port&gt;} argument must be the string
   * representation of the number of the TCP port
   * on which the host is listening for the data connection.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 200&lt;br&gt;
   * 500, 501, 522, 421, 530&lt;br&gt;
   */
<span class="fc" id="L1092">  EPRT(org.waarp.ftp.core.command.rfc2428.EPRT.class, null),</span>
  /**
   * The EPSV command requests that a server listen on a data port and wait
   * for
   * a connection. The EPSV command
   * takes an optional argument. The response to this command includes only
   * the
   * TCP port number of the listening
   * connection. The format of the response, however, is similar to the
   * argument
   * of the EPRT command. This
   * allows the same parsing routines to be used for both commands. In
   * addition,
   * the format leaves a place
   * holder for the network protocol and/or network address, which may be
   * needed
   * in the EPSV response in the
   * future. The response code for entering passive mode using an extended
   * address MUST be 229. The
   * interpretation of this code, according to [PR85] is:&lt;br&gt;
   * &lt;br&gt;
   *
   * &lt;pre&gt;
   * 2yz Positive Completion
   *         x2z Connections
   *         xy9 Extended Passive Mode Entered
   * &lt;/pre&gt;
   *
   * &lt;br&gt;
   * The text returned in response to the EPSV command MUST be:&lt;br&gt;
   * &lt;br&gt;
   *
   * &lt;pre&gt;
   * &amp;lt;text indicating server is entering extended passive mode&amp;gt; (&amp;lt;d&amp;gt;&amp;lt;d&amp;gt;&amp;lt;d&amp;gt;&amp;lt;tcp-port&amp;gt;&amp;lt;d&amp;gt;)
   * &lt;/pre&gt;
   *
   * &lt;br&gt;
   * The portion of the string enclosed in parentheses MUST be the exact
   * string
   * needed by the EPRT command to
   * open the data connection, as specified above.&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * The first two fields contained in the parenthesis MUST be blank. The
   * third
   * field MUST be the string
   * representation of the TCP port number on which the server is listening
   * for
   * a data connection. The network
   * protocol used by the data connection will be the same network protocol
   * used
   * by the control connection. In
   * addition, the network address used to establish the data connection will
   * be
   * the same network address used
   * for the control connection. An example response string follows:&lt;br&gt;
   * &lt;br&gt;
   *
   * &lt;pre&gt;
   * Entering Extended Passive Mode (|||6446|)
   * &lt;/pre&gt;
   *
   * &lt;br&gt;
   * The standard negative error codes 500 and 501 are sufficient to handle
   * all
   * errors involving the EPSV
   * command (e.g., syntax errors).&lt;br&gt;
   * &lt;br&gt;
   * &lt;p&gt;
   * When the EPSV command is issued with no argument, the server will choose
   * the network protocol for the data
   * connection based on the protocol used for the control connection.
   * However,
   * in the case of proxy FTP, this
   * protocol might not be appropriate for communication between the two
   * servers. Therefore, the client needs to
   * be able to request a specific protocol. If the server returns a protocol
   * that is not supported by the host
   * that will be connecting to the port, the client MUST issue an ABOR
   * (abort)
   * command to allow the server to
   * close down the listening connection. The client can then send an EPSV
   * command requesting the use of a
   * specific network protocol, as follows:&lt;br&gt;
   * &lt;br&gt;
   *
   * &lt;pre&gt;
   * EPSV&amp;lt;space&amp;gt;&amp;lt;net-prt&amp;gt;
   * &lt;/pre&gt;
   *
   * &lt;br&gt;
   * If the requested protocol is supported by the server, it SHOULD use the
   * protocol. If not, the server MUST
   * return the 522 error messages as outlined in section 2.&lt;br&gt;
   * &lt;br&gt;
   *
   * &lt;b&gt;The following part is not implemented.&lt;/b&gt;&lt;br&gt;
   * Finally, the EPSV command can be used with the argument &quot;ALL&quot; to inform
   * Network Address Translators that
   * the EPRT command (as well as other data commands) will no longer be
   * used.
   * An example of this command
   * follows:&lt;br&gt;
   * &lt;br&gt;
   *
   * &lt;pre&gt;
   * EPSV &amp;lt; space &amp;gt; ALL
   * &lt;/pre&gt;
   *
   * &lt;br&gt;
   * Upon receipt of an EPSV ALL command, the server MUST reject all data
   * connection setup commands other than
   * EPSV (i.e., EPRT, PORT, PASV, et al.). This use of the EPSV command is
   * further explained in section 4.&lt;br&gt;
   * &lt;p&gt;
   * &lt;p&gt;
   * 229&lt;br&gt;
   * 500, 501, 502, 522, 421, 530&lt;br&gt;
   */
<span class="fc" id="L1211">  EPSV(org.waarp.ftp.core.command.rfc2428.EPSV.class, null),</span>

  // XXX EXTENSIONS

  /**
   * Compute CRC on pathname given as argument. Return on control network as
   * 250
   * &quot;CRC&quot; is CRC of file
   * &quot;pathname&quot;&lt;br&gt;
   * &lt;p&gt;
   * 250&lt;br&gt;
   * 500, 501, 502, 504, 421, 530&lt;br&gt;
   */
<span class="fc" id="L1224">  XCRC(org.waarp.ftp.core.command.extension.XCRC.class, null),</span>
  /**
   * Compute MD5 on pathname given as argument. Return on control network as
   * 250
   * &quot;MD5&quot; is MD5 of file
   * &quot;pathname&quot;&lt;br&gt;
   * &lt;p&gt;
   * 250&lt;br&gt;
   * 500, 501, 502, 504, 421, 530&lt;br&gt;
   */
<span class="fc" id="L1234">  XMD5(org.waarp.ftp.core.command.extension.XMD5.class, null),</span>
  /**
   * Compute SHA-1 on pathname given as argument. Return on control network as
   * 250 &quot;SHA1&quot; is SHA-1 of file
   * &quot;pathname&quot;&lt;br&gt;
   * &lt;p&gt;
   * 250&lt;br&gt;
   * 500, 501, 502, 504, 421, 530&lt;br&gt;
   */
<span class="fc" id="L1243">  XSHA1(org.waarp.ftp.core.command.extension.XSHA1.class, null),</span>
  /**
   * Compute Digest on pathname given as second argument, first being the
   * digest algorithm. Return on control network as
   * 250 &quot;DIGEST&quot; is Digest of file
   * &quot;pathname&quot;&lt;br&gt;
   * &lt;p&gt;
   * 250&lt;br&gt;
   * 500, 501, 502, 504, 421, 530&lt;br&gt;
   */
<span class="fc" id="L1253">  XDIGEST(org.waarp.ftp.core.command.extension.XDIGEST.class, null),</span>

  // XXX GLOBAL OPERATION
  /**
   * Unknown Command from control network&lt;br&gt;
   * Always return 500&lt;br&gt;
   */
<span class="fc" id="L1260">  Unknown(UnknownCommand.class, null),</span>
  /**
   * Unimplemented command&lt;br&gt;
   * Always return 502&lt;br&gt;
   */
<span class="fc" id="L1265">  Unimplemented(UnimplementedCommand.class, null),</span>
  /**
   * Bad sequence of commands&lt;br&gt;
   * Always return 503&lt;br&gt;
   */
<span class="fc" id="L1270">  IncorrectSequence(IncorrectCommand.class, null),</span>

  // XXX INTERNAL FUNCTION

  /**
   * Shutdown command (internal password protected command).&lt;br&gt;
   * Shutdown the FTP service&lt;br&gt;
   */
<span class="fc" id="L1278">  INTERNALSHUTDOWN(org.waarp.ftp.core.command.internal.INTERNALSHUTDOWN.class,</span>
                   null),
  /**
   * Change the Limit of the global bandwidth.&lt;br&gt;
   * No argument reset to default, 1 argument change both write and read to
   * same
   * value, 2 arguments stand for
   * write then read limit.&lt;br&gt;
   * Limit is written in byte/s. Example: &quot;LIMITBANDWIDTH 104857600
   * 104857600&quot;
   * stands for 100MB/s limitation
   * globaly.&lt;br&gt;
   * -1 means no limit
   */
<span class="fc" id="L1292">  LIMITBANDWIDTH(org.waarp.ftp.core.command.internal.LIMITBANDWIDTH.class,</span>
                 null),

  // XXX RFC 4217 on SSL/TLS support through commands
  /**
   * After an AUTH =&gt; equivalent to REIN so no more authenticated, USER is mandatory, except if PROT is used in
   * between.&lt;br&gt;
   * So the order will be:&lt;br&gt;
   * whatever until authenticated -&gt; AUTH xxx -&gt; USER or [PBSZ 0] / PROT xxx / USER&lt;br&gt;
   * &lt;br&gt;
   * Security-Enhanced login commands (only new replies listed)&lt;br&gt;
   * USER&lt;br&gt;
   * 232&lt;br&gt;
   * 336&lt;br&gt;
   * &lt;br&gt;
   * Data channel commands (only new replies listed)&lt;br&gt;
   * STOR&lt;br&gt;
   * 534, 535&lt;br&gt;
   * STOU&lt;br&gt;
   * 534, 535&lt;br&gt;
   * RETR&lt;br&gt;
   * 534, 535&lt;br&gt;
   * LIST&lt;br&gt;
   * 534, 535&lt;br&gt;
   * NLST&lt;br&gt;
   * 534, 535&lt;br&gt;
   * APPE&lt;br&gt;
   * 534, 535
   *
   * Security Association Setup AUTH TLS (Control) or AUTH SSL (Control and
   * Data)&lt;br&gt;
   * 234*&lt;br&gt;
   * 502, 504, 534*, 431* 500, 501, 421&lt;br&gt;
   * &lt;br&gt;
   * AUTH TLS -&gt; 234 -&gt; USER or ([PBSZ 0] PROT P then USER) -&gt; 2xy
   */
<span class="fc" id="L1328">  AUTH(org.waarp.ftp.core.command.rfc4217.AUTH.class, null,</span>
       org.waarp.ftp.core.command.rfc2389.OPTS.class,
       org.waarp.ftp.core.command.rfc4217.PROT.class,
       org.waarp.ftp.core.command.rfc4217.PBSZ.class,
       org.waarp.ftp.core.command.access.USER.class),
  /**
   * Security Association Setup&lt;br&gt;
   * CCC (Control SSL Off)&lt;br&gt;
   * 200&lt;br&gt;
   * 500, 533*, 534*
   */
<span class="fc" id="L1339">  CCC(org.waarp.ftp.core.command.rfc4217.CCC.class, null),</span>
  /**
   * Data protection negotiation commands&lt;br&gt;
   * PROT P (Data)&lt;br&gt;
   * PROT C (Data SSL Off)&lt;br&gt;
   * 200&lt;br&gt;
   * 504, 536*, 503, 534*, 431* 500, 501, 421, 530
   */
<span class="fc" id="L1347">  PROT(org.waarp.ftp.core.command.rfc4217.PROT.class, null),</span>
  /**
   * Data protection negotiation commands&lt;br&gt;
   * PBSZ 0&lt;br&gt;
   * 200&lt;br&gt;
   * 503, 500, 501, 421, 530
   */
<span class="fc" id="L1354">  PBSZ(org.waarp.ftp.core.command.rfc4217.PBSZ.class, null);</span>

  /**
   * The Class that implements this command
   */
  public final Class&lt;? extends AbstractCommand&gt; command;

  /**
   * Previous positive class that must precede this command (null means any)
   */
  public final Class&lt;? extends AbstractCommand&gt; previousValid;

  /**
   * Next valids class that could follow this command (null means any)
   */
  public final Class&lt;?&gt;[] nextValids;

  FtpCommandCode(final Class&lt;? extends AbstractCommand&gt; command,
                 final Class&lt;? extends AbstractCommand&gt; previousValid,
<span class="fc" id="L1373">                 final Class&lt;?&gt;... nextValids) {</span>
<span class="fc" id="L1374">    this.command = command;</span>
<span class="fc" id="L1375">    this.previousValid = previousValid;</span>
<span class="fc" id="L1376">    this.nextValids = nextValids;</span>
<span class="fc" id="L1377">  }</span>

  /**
   * Get the corresponding AbstractCommand object from the line received from
   * the client associated with the
   * handler
   *
   * @param session
   * @param line
   *
   * @return the AbstractCommand from the line received from the client
   */
  public static AbstractCommand getFromLine(final FtpSession session,
                                            final String line) {
    FtpCommandCode ftpCommandCode;
<span class="fc" id="L1392">    String newline = line;</span>
<span class="pc bpc" id="L1393" title="1 of 2 branches missed.">    if (newline == null) {</span>
<span class="nc" id="L1394">      ftpCommandCode = Unknown;</span>
<span class="nc" id="L1395">      newline = &quot;&quot;;</span>
    }
    final String command;
    String arg;
<span class="fc bfc" id="L1399" title="All 2 branches covered.">    if (newline.indexOf(' ') == -1) {</span>
<span class="fc" id="L1400">      command = newline;</span>
<span class="fc" id="L1401">      arg = null;</span>
    } else {
<span class="fc" id="L1403">      command = newline.substring(0, newline.indexOf(' '));</span>
<span class="fc" id="L1404">      arg = newline.substring(newline.indexOf(' ') + 1);</span>
<span class="pc bpc" id="L1405" title="1 of 2 branches missed.">      if (arg.length() == 0) {</span>
<span class="nc" id="L1406">        arg = null;</span>
      }
    }
<span class="fc" id="L1409">    final String COMMAND = command.toUpperCase();</span>
    try {
<span class="fc" id="L1411">      ftpCommandCode = valueOf(COMMAND);</span>
<span class="nc" id="L1412">    } catch (final IllegalArgumentException e) {</span>
<span class="nc" id="L1413">      ftpCommandCode = Unknown;</span>
<span class="fc" id="L1414">    }</span>
<span class="fc" id="L1415">    final AbstractCommand abstractCommand =</span>
<span class="fc" id="L1416">        getAbstractCommand(ftpCommandCode, session);</span>
<span class="pc bpc" id="L1417" title="1 of 2 branches missed.">    if (abstractCommand instanceof UnknownCommand) {</span>
<span class="nc" id="L1418">      abstractCommand.setArgs(session, COMMAND, arg, Unknown);</span>
    } else {
<span class="fc" id="L1420">      abstractCommand.setArgs(session, COMMAND, arg, ftpCommandCode);</span>
    }
<span class="fc" id="L1422">    return abstractCommand;</span>
  }

  private static AbstractCommand getAbstractCommand(final FtpCommandCode code,
                                                    final FtpSession session) {
<span class="pc bpc" id="L1427" title="31 of 59 branches missed.">    switch (code) {</span>
      case Connection:
<span class="nc" id="L1429">        return new ConnectionCommand(session);</span>
      case USER:
<span class="fc" id="L1431">        return new org.waarp.ftp.core.command.access.USER();</span>
      case PASS:
<span class="fc" id="L1433">        return new org.waarp.ftp.core.command.access.PASS();</span>
      case ACCT:
<span class="fc" id="L1435">        return new org.waarp.ftp.core.command.access.ACCT();</span>
      case CWD:
<span class="fc" id="L1437">        return new org.waarp.ftp.core.command.directory.CWD();</span>
      case CDUP:
<span class="nc" id="L1439">        return new org.waarp.ftp.core.command.directory.CDUP();</span>
      case SMNT:
<span class="nc" id="L1441">        return new org.waarp.ftp.core.command.directory.SMNT();</span>
      case REIN:
<span class="nc" id="L1443">        return new org.waarp.ftp.core.command.access.REIN();</span>
      case QUIT:
<span class="fc" id="L1445">        return new org.waarp.ftp.core.command.access.QUIT();</span>
      case PORT:
<span class="fc" id="L1447">        return new org.waarp.ftp.core.command.parameter.PORT();</span>
      case PASV:
<span class="fc" id="L1449">        return new org.waarp.ftp.core.command.parameter.PASV();</span>
      case TYPE:
<span class="fc" id="L1451">        return new org.waarp.ftp.core.command.parameter.TYPE();</span>
      case STRU:
<span class="nc" id="L1453">        return new org.waarp.ftp.core.command.parameter.STRU();</span>
      case MODE:
<span class="fc" id="L1455">        return new org.waarp.ftp.core.command.parameter.MODE();</span>
      case RETR:
<span class="fc" id="L1457">        return new org.waarp.ftp.core.command.service.RETR();</span>
      case STOR:
<span class="fc" id="L1459">        return new org.waarp.ftp.core.command.service.STOR();</span>
      case STOU:
<span class="nc" id="L1461">        return new org.waarp.ftp.core.command.service.STOU();</span>
      case APPE:
<span class="nc" id="L1463">        return new org.waarp.ftp.core.command.service.APPE();</span>
      case ALLO:
<span class="nc" id="L1465">        return new org.waarp.ftp.core.command.service.ALLO();</span>
      case REST:
<span class="fc" id="L1467">        return new org.waarp.ftp.core.command.service.REST();</span>
      case RNFR:
<span class="nc" id="L1469">        return new org.waarp.ftp.core.command.service.RNFR();</span>
      case RNTO:
<span class="nc" id="L1471">        return new org.waarp.ftp.core.command.service.RNTO();</span>
      case ABOR:
<span class="nc" id="L1473">        return new org.waarp.ftp.core.command.service.ABOR();</span>
      case DELE:
<span class="fc" id="L1475">        return new org.waarp.ftp.core.command.service.DELE();</span>
      case RMD:
<span class="nc" id="L1477">        return new org.waarp.ftp.core.command.service.RMD();</span>
      case MKD:
<span class="fc" id="L1479">        return new org.waarp.ftp.core.command.service.MKD();</span>
      case PWD:
<span class="nc" id="L1481">        return new org.waarp.ftp.core.command.service.PWD();</span>
      case LIST:
<span class="fc" id="L1483">        return new org.waarp.ftp.core.command.service.LIST();</span>
      case NLST:
<span class="nc" id="L1485">        return new org.waarp.ftp.core.command.service.NLST();</span>
      case SITE:
<span class="fc" id="L1487">        return new org.waarp.ftp.core.command.info.SITE();</span>
      case SYST:
<span class="fc" id="L1489">        return new org.waarp.ftp.core.command.info.SYST();</span>
      case STAT:
<span class="nc" id="L1491">        return new org.waarp.ftp.core.command.info.STAT();</span>
      case HELP:
<span class="nc" id="L1493">        return new org.waarp.ftp.core.command.info.HELP();</span>
      case NOOP:
<span class="fc" id="L1495">        return new org.waarp.ftp.core.command.info.NOOP();</span>
      case XCWD:
<span class="nc" id="L1497">        return new org.waarp.ftp.core.command.rfc775.XCWD();</span>
      case XCUP:
<span class="nc" id="L1499">        return new org.waarp.ftp.core.command.rfc775.XCUP();</span>
      case XRMD:
<span class="nc" id="L1501">        return new org.waarp.ftp.core.command.rfc775.XRMD();</span>
      case XMKD:
<span class="nc" id="L1503">        return new org.waarp.ftp.core.command.rfc775.XMKD();</span>
      case XPWD:
<span class="nc" id="L1505">        return new org.waarp.ftp.core.command.rfc775.XPWD();</span>
      case MDTM:
<span class="nc" id="L1507">        return new org.waarp.ftp.core.command.rfc3659.MDTM();</span>
      case SIZE:
<span class="nc" id="L1509">        return new org.waarp.ftp.core.command.rfc3659.SIZE();</span>
      case MLSD:
<span class="fc" id="L1511">        return new org.waarp.ftp.core.command.rfc3659.MLSD();</span>
      case MLST:
<span class="nc" id="L1513">        return new org.waarp.ftp.core.command.rfc3659.MLST();</span>
      case FEAT:
<span class="fc" id="L1515">        return new org.waarp.ftp.core.command.rfc2389.FEAT();</span>
      case OPTS:
<span class="nc" id="L1517">        return new org.waarp.ftp.core.command.rfc2389.OPTS();</span>
      case EPRT:
<span class="nc" id="L1519">        return new org.waarp.ftp.core.command.rfc2428.EPRT();</span>
      case EPSV:
<span class="nc" id="L1521">        return new org.waarp.ftp.core.command.rfc2428.EPSV();</span>
      case XCRC:
<span class="fc" id="L1523">        return new org.waarp.ftp.core.command.extension.XCRC();</span>
      case XMD5:
<span class="fc" id="L1525">        return new org.waarp.ftp.core.command.extension.XMD5();</span>
      case XSHA1:
<span class="fc" id="L1527">        return new org.waarp.ftp.core.command.extension.XSHA1();</span>
      case XDIGEST:
<span class="fc" id="L1529">        return new org.waarp.ftp.core.command.extension.XDIGEST();</span>
      case IncorrectSequence:
<span class="nc" id="L1531">        return new IncorrectCommand();</span>
      case INTERNALSHUTDOWN:
<span class="fc" id="L1533">        return new org.waarp.ftp.core.command.internal.INTERNALSHUTDOWN();</span>
      case LIMITBANDWIDTH:
<span class="nc" id="L1535">        return new org.waarp.ftp.core.command.internal.LIMITBANDWIDTH();</span>
      case AUTH:
<span class="fc" id="L1537">        return new org.waarp.ftp.core.command.rfc4217.AUTH();</span>
      case CCC:
<span class="nc" id="L1539">        return new org.waarp.ftp.core.command.rfc4217.CCC();</span>
      case PROT:
<span class="fc" id="L1541">        return new org.waarp.ftp.core.command.rfc4217.PROT();</span>
      case PBSZ:
<span class="fc" id="L1543">        return new org.waarp.ftp.core.command.rfc4217.PBSZ();</span>
      case Unknown:
      case Unimplemented:
      default:
<span class="nc" id="L1547">        return new UnknownCommand();</span>
    }
  }

  /**
   * True if the command is a Store like operation (APPE, STOR, STOU, ...)
   *
   * @param command
   *
   * @return True if the command is a Store like operation (APPE, STOR, STOU,
   *     ...)
   */
  public static boolean isStoreLikeCommand(final FtpCommandCode command) {
<span class="pc bpc" id="L1560" title="2 of 6 branches missed.">    return command == APPE || command == STOR || command == STOU;</span>
  }

  /**
   * True if the command is a Retrieve like operation (RETR, ...)
   *
   * @param command
   *
   * @return True if the command is a Retrieve like operation (RETR, ...)
   */
  public static boolean isRetrLikeCommand(final FtpCommandCode command) {
<span class="fc bfc" id="L1571" title="All 2 branches covered.">    return command == RETR;</span>
  }

  /**
   * True if the command is a Retrieve or Store like operation
   *
   * @param command
   *
   * @return True if the command is a Retrieve or Store like operation
   */
  public static boolean isStorOrRetrLikeCommand(final FtpCommandCode command) {
<span class="pc bpc" id="L1582" title="1 of 4 branches missed.">    return isRetrLikeCommand(command) || isStoreLikeCommand(command);</span>
  }

  /**
   * True if the command is a List like operation (LIST, NLST, MLSD, MLST,
   * ...)
   *
   * @param command
   *
   * @return True if the command is a List like operation (LIST, NLST, MLSD,
   *     MLST, ...)
   */
  public static boolean isListLikeCommand(final FtpCommandCode command) {
<span class="pc bpc" id="L1595" title="2 of 8 branches missed.">    return command == LIST || command == NLST || command == MLSD ||</span>
           command == MLST;
  }

  /**
   * True if the command is using a Data connection
   *
   * @param command
   *
   * @return True if the command is using a Data Connection
   */
  public static boolean isDataConnectionUsageCommand(
      final FtpCommandCode command) {
<span class="nc bnc" id="L1608" title="All 4 branches missed.">    return isRetrLikeCommand(command) || isStoreLikeCommand(command) ||</span>
<span class="nc bnc" id="L1609" title="All 2 branches missed.">           isListLikeCommand(command);</span>
  }

  /**
   * True if the command is a special operation (QUIT, ABOR, NOOP, STAT, ...)
   *
   * @param command
   *
   * @return True if the command is a special operation (QUIT, ABOR, NOOP,
   *     STAT,
   *     ...)
   */
  public static boolean isSpecialCommand(final FtpCommandCode command) {
<span class="pc bpc" id="L1622" title="2 of 8 branches missed.">    return command == QUIT || command == ABOR || command == NOOP ||</span>
           command == STAT;
  }

  /**
   * True if the command is Ssl related (AUTH, PBSZ, PROT, USER, PASS, ACCT,
   * CCC)
   *
   * @param command
   *
   * @return True if the command is Ssl related (AUTH, PBSZ, PROT, USER, PASS,
   *     ACCT, CCC)
   */
  public static boolean isSslOrAuthCommand(final FtpCommandCode command) {
<span class="pc bpc" id="L1636" title="1 of 12 branches missed.">    return command == AUTH || command == PBSZ || command == PROT ||</span>
           command == PASS || command == ACCT || command == CCC;
  }

  /**
   * True if the command is an extension operation (XMD5, XCRC, XSHA1, ...)
   *
   * @param command
   *
   * @return True if the command is an extension operation (XMD5, XCRC, XSHA1,
   *     ...)
   */
  public static boolean isExtensionCommand(final FtpCommandCode command) {
<span class="pc bpc" id="L1649" title="3 of 12 branches missed.">    return command == XMD5 || command == XCRC || command == XSHA1 ||</span>
           command == XDIGEST || command == INTERNALSHUTDOWN ||
           command == LIMITBANDWIDTH;
  }

  @Override
  public String toString() {
<span class="fc" id="L1656">    return name();</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>