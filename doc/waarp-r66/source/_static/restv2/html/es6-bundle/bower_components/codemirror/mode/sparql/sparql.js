// CodeMirror, copyright (c) by Marijn Haverbeke and others
// Distributed under an MIT license: https://codemirror.net/LICENSE
(function(mod){if("object"==typeof exports&&"object"==typeof module)// CommonJS
mod(require("../../lib/codemirror"));else if("function"==typeof define&&define.amd)// AMD
define(["../../lib/codemirror"],mod);else// Plain browser env
mod(CodeMirror)})(function(CodeMirror){"use strict";CodeMirror.defineMode("sparql",function(config){var indentUnit=config.indentUnit,curPunc;function wordRegexp(words){return new RegExp("^(?:"+words.join("|")+")$","i")}var ops=wordRegexp(["str","lang","langmatches","datatype","bound","sameterm","isiri","isuri","iri","uri","bnode","count","sum","min","max","avg","sample","group_concat","rand","abs","ceil","floor","round","concat","substr","strlen","replace","ucase","lcase","encode_for_uri","contains","strstarts","strends","strbefore","strafter","year","month","day","hours","minutes","seconds","timezone","tz","now","uuid","struuid","md5","sha1","sha256","sha384","sha512","coalesce","if","strlang","strdt","isnumeric","regex","exists","isblank","isliteral","a","bind"]),keywords=wordRegexp(["base","prefix","select","distinct","reduced","construct","describe","ask","from","named","where","order","limit","offset","filter","optional","graph","by","asc","desc","as","having","undef","values","group","minus","in","not","service","silent","using","insert","delete","union","true","false","with","data","copy","to","move","add","create","drop","clear","load"]),operatorChars=/[*+\-<>=&|\^\/!\?]/;function tokenBase(stream,state){var ch=stream.next();curPunc=null;if("$"==ch||"?"==ch){if("?"==ch&&stream.match(/\s/,/* eat */ /* ignoreName */ /* ignoreName */!1/* skipSlots */ /* skipSlots */)){return"operator"}stream.match(/^[\w\d]*/);return"variable-2"}else if("<"==ch&&!stream.match(/^[\s\u00a0=]/,!1)){stream.match(/^[^\s\u00a0>]*>?/);return"atom"}else if("\""==ch||"'"==ch){state.tokenize=tokenLiteral(ch);return state.tokenize(stream,state)}else if(/[{}\(\),\.;\[\]]/.test(ch)){curPunc=ch;return"bracket"}else if("#"==ch){stream.skipToEnd();return"comment"}else if(operatorChars.test(ch)){stream.eatWhile(operatorChars);return"operator"}else if(":"==ch){stream.eatWhile(/[\w\d\._\-]/);return"atom"}else if("@"==ch){stream.eatWhile(/[a-z\d\-]/i);return"meta"}else{stream.eatWhile(/[_\w\d]/);if(stream.eat(":")){stream.eatWhile(/[\w\d_\-]/);return"atom"}var word=stream.current();if(ops.test(word))return"builtin";else if(keywords.test(word))return"keyword";else return"variable"}}function tokenLiteral(quote){return function(stream,state){var escaped=!1,ch;while(null!=(ch=stream.next())){if(ch==quote&&!escaped){state.tokenize=tokenBase;break}escaped=!escaped&&"\\"==ch}return"string"}}function pushContext(state,type,col){state.context={prev:state.context,indent:state.indent,col:col,type:type}}function popContext(state){state.indent=state.context.indent;state.context=state.context.prev}return{startState:function(){return{tokenize:tokenBase,context:null,indent:0,col:0}},token:function(stream,state){if(stream.sol()){if(state.context&&null==state.context.align)state.context.align=!1;state.indent=stream.indentation()}if(stream.eatSpace())return null;var style=state.tokenize(stream,state);if("comment"!=style&&state.context&&null==state.context.align&&"pattern"!=state.context.type){state.context.align=!0/* skipSlots */}if("("==curPunc)pushContext(state,")",stream.column());else if("["==curPunc)pushContext(state,"]",stream.column());else if("{"==curPunc)pushContext(state,"}",stream.column());else if(/[\]\}\)]/.test(curPunc)){while(state.context&&"pattern"==state.context.type)popContext(state);if(state.context&&curPunc==state.context.type){popContext(state);if("}"==curPunc&&state.context&&"pattern"==state.context.type)popContext(state)}}else if("."==curPunc&&state.context&&"pattern"==state.context.type)popContext(state);else if(/atom|string|variable/.test(style)&&state.context){if(/[\}\]]/.test(state.context.type))pushContext(state,"pattern",stream.column());else if("pattern"==state.context.type&&!state.context.align){state.context.align=!0;state.context.col=stream.column()}}return style},indent:function(state,textAfter){var firstChar=textAfter&&textAfter.charAt(0),context=state.context;if(/[\]\}]/.test(firstChar))while(context&&"pattern"==context.type)context=context.prev;var closing=context&&firstChar==context.type;if(!context)return 0;else if("pattern"==context.type)return context.col;else if(context.align)return context.col+(closing?0:1);else return context.indent+(closing?0:indentUnit)},lineComment:"#"}});CodeMirror.defineMIME("application/sparql-query","sparql")});