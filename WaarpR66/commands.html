<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.1 from src/site/apt/commands.apt at 2020-06-02

 | Rendered using Apache Maven Default Skin
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.1" />
    <title>Waarp OpenR66 &#x2013; </title>
    <link rel="stylesheet" href="./css/maven-base.css" />
    <link rel="stylesheet" href="./css/maven-theme.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
  </head>
  <body class="composite">
    <div id="banner">
<a href="http://www.waarp.fr" id="bannerLeft"><img src="images/waarp.jpg"  alt="Waarp Project"/></a>      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">
        <span id="publishDate">Last Published: 2020-06-02</span>
          &#xA0;| <span id="projectVersion">Version: 3.3.4</span>
      </div>
      <div class="xright"><a href="http://www.waarp.fr/" class="externalLink" title="Waarp">Waarp</a>      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
       <h5>Waarp OpenR66</h5>
    <ul>
     <li class="none"><a href="index.html" title="Overview of OpenR66">Overview of OpenR66</a></li>
     <li class="none"><a href="configuration.html" title="Configuration of OpenR66 Server and Clients">Configuration of OpenR66 Server and Clients</a></li>
     <li class="none"><a href="sslconfig.html" title="Configuration of OpenR66 SSL keys">Configuration of OpenR66 SSL keys</a></li>
     <li class="none"><strong>Commands for OpenR66 Server and Clients</strong></li>
     <li class="none"><a href="protocol.html" title="Protocol for OpenR66 File Transfer">Protocol for OpenR66 File Transfer</a></li>
    </ul>
       <h5>Project Documentation</h5>
    <ul>
     <li class="collapsed"><a href="project-reports.html" title="Project Reports">Project Reports</a></li>
    </ul>
      <a href="https://www.waarp.fr/" title="Waarp" class="poweredBy">
        <img class="poweredBy"  alt="Waarp" src="https://www.waarp.fr/i/logo.png"     />
      </a>
      </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
<section>
<h2><a name="OpenR66-Command"></a>OpenR66-Command</h2>
<p>OpenR66 is mainly a set of commands,from the server, to the clients, through utilities.</p><section>
<h3><a name="R66Server"></a>R66Server</h3>
<p>It launches the OpenR66 Server using as unique argument the full XML configuration file. It loads the rest of the configuration (or update its configuration) from the database specified in the XML configuration file.</p>
<p>By default, three services are opened:</p>
<ul>
<li>Non SSL file transfer monitor</li>
<li>SSL file transfer monitor</li>
<li>HTTP file transfer observer</li></ul>
<p>By default, 5 subdirectories (under the main home) are defined:</p>
<ul>
<li>Config directory where configurations files are stored</li>
<li>Archive directory where archive transfer can be put (using post actions) or where transfer logs are placed</li>
<li>Input directory where received files are stored (except if a post action moves it)</li>
<li>Output directory where to be sent files are stored (or linked)</li>
<li>Working directory where currently received files are temporarily placed</li></ul></section><section>
<h3><a name="Utilities:"></a>Utilities:</h3><section>
<h4><a name="ServerInitDatabase"></a>ServerInitDatabase</h4>
<p>The first step in installation of an OpenR66 Server or heavy client is to construct the XML configuration files and to initiate the database that support file transfers and configurations. This function is an helper for database initialization.</p>
<ul>
<li>The first argument is the JDBC database connection XML file. It will try to create the database tables and to initiate the sequence (unique Id by host of runners from runner table).
<p>From there any argument are optional but in that order. Any existing data will be replaced. No data are deleted if not replaced.</p></li>
<li>-initdb : try to create database. It stops at the first error but the program continues.</li>
<li>-dir directory : This argument is the directory from where to load rules into the database using the XML rule files present in this directory (rules table).</li>
<li>-auth fileHost : This argument is to load the host authentication XML file into the database (hosts table).</li>
<li>-limit limitConfig : This argument is to load the bandwidth XML file into the database (configuration table).</li></ul>
<p>From that point, the OpenR66 server (R66Server) can be started.</p></section><section>
<h4><a name="ServerExportConfiguration"></a>ServerExportConfiguration</h4>
<p>One of the ideas of OpenR66 is the ability to centralized some information asynchronously into a centralized database. This centralization can be in two ways:</p>
<ul>
<li>Import new rules, host authentication or bandwidth limitation: this can be done using the ServerInitDatabase after some file transfers from a post operation which could execute this utility.</li>
<li>Export rules, hosts authentication and actual runners (done or not): this is the goal of this utility. It takes two arguments:
<ul>
<li>The client configuration XML file</li>
<li>The directory where to export files in XML format</li></ul>
<p>It will export Rules, all present Runners, Host Authentications.</p></li></ul></section><section>
<h4><a name="ConfigExport"></a>ConfigExport</h4>
<p>This tool enables to ask the server remotely to export Rules and Hosts configuration into one file each. It could be used before a retrieve of the configuration in a central repository.</p>
<p>Options are:</p>
<ul>
<li>The first argument is the client XML configuration file
<ul>
<li>-hosts : export all Hosts configuration</li>
<li>-rules : export all Rules configuration</li></ul></li></ul></section><section>
<h4><a name="ConfigImport"></a>ConfigImport</h4>
<p>This tool enables to ask the server remotely to import Rules and Hosts configuration from one file each. It could be used before a upload the configuration from a central repository after transmission.</p>
<p>Options are:</p>
<ul>
<li>The first argument is the client XML configuration file
<ul>
<li>-hosts : import all Hosts configuration</li>
<li>-purgehosts : purge all hosts configuration before importing new configuration</li>
<li>-rules : import all Rules configuration</li>
<li>-purgerules : purge all rules configuration before importing new configuration</li></ul></li></ul></section><section>
<h4><a name="ServerShutdown"></a>ServerShutdown</h4>
<p>The OpenR66 Server can be shutdown mainly in two ways:</p>
<ul>
<li>Sending a -SIGTERM signal (or under Unix a -SIGUSR1 signal) to the JVM process hosting the OpenR66 Server.</li>
<li>The prefered way is to use the HTTPS Administrator interface.</li>
<li>Another preferred way is to use this utility which sends a shutdown request through network but using a key shared physically (adminkey). This utility takes the same XML configuration file than the server (where the admin key is referred but not stored in any database) and uses the SSL service.</li>
<li>If one wants to used the non SSL service, it should create a new utility and changing:
<ul>
<li>&quot;SERVER_SSLPORT&quot; to &quot;SERVER_PORT&quot;</li>
<li>&quot;createConnectionWithRetry(socketServerAddress,true, null);&quot; to &quot;createConnectionWithRetry(socketServerAddress,false, null);&quot;.</li></ul></li></ul></section><section>
<h4><a name="LogExport"></a>LogExport</h4>
<p>If one wants to centralized in asynchronous way the transfer logs, this utility is made for it. Its purpose is to export logs into the archive directory and to eventually purge them from database. It sends a local request to the server, which really export the logs into a file. No file are transfered, they are just export to a file in the global archive directory. To use it, two main ways can be achieved:</p>
<ul>
<li>The local server runs this tool referring the OpenR66 Server using the client configuration XML file and then running a log request.</li>
<li>Directly runs a transfer request where the rule execute at pre processing this utility (again either in receive or send mode according to the initiate server).</li>
<li>The First argument is the Client Configuration (eventually without database access).</li>
<li>The rest of arguments can be:
<ul>
<li>'-clean' option: Change all UpdatedInfo to Done where GlobalLastTask is ALLDONETASK and status is CompleteOk (sometimes some runners can be done but UpdatedInfo could be erroneous - no impact but clean function -).</li>
<li>'-purge' option: This option removes all ALLDONETASK from those that will be exported.</li>
<li>'-start' option: This option specifies the low limit to select runners from start runner time. If not specified, there is no low limit.</li>
<li>'-stop' option: This option specifies the upper limit to select runners from start runner time. If not specified, there is no upper limit.</li></ul></li></ul></section><section>
<h4><a name="ChangeBandwidthLimits"></a>ChangeBandwidthLimits</h4>
<p>This tool enables to change dynamically the bandwidth limitations (only in memory, not in database). To use it, it should be used locally with the admin account.</p>
<ul>
<li>The First argument is the Client Configuration (eventually without database access).</li>
<li>The rest of arguments can be:
<ul>
<li>'-wglob' option: Write Global limitation in Bytes by Second (minimum 1024 so 1KBs).</li>
<li>'-rglob' option: Read Global limitation in Bytes by Second (minimum 1024 so 1KBs).</li>
<li>'-wsess' option: Write Session limitation in Bytes by Second (minimum 1024 so 1KBs).</li>
<li>'-rsess' option: Read Session limitation in Bytes by Second (minimum 1024 so 1KBs).</li></ul></li></ul></section></section><section>
<h3><a name="Clients:"></a>Clients:</h3><section>
<h4><a name="SubmitTransfer"></a>SubmitTransfer</h4>
<p>To transfer a file, two main methods exist. This one is a submission request, so an asynchronous operation since once the request is submitted, the client returns without waiting for the end of the operation.</p>
<p>It takes the following argument:</p>
<ul>
<li>The client XML configuration file as first argument, the one including database access</li>
<li>At least 3 other arguments are necessary:
<ul>
<li>'-to' option: specifies the remote Host Id (either the Id for SSL or not ).</li>
<li>'-file' option: specifies the file to transfer (either in receive or send mode).</li>
<li>'-rule' option: specifies the rule to apply (which specifies the transfer mode, the pre, post or error operations, ...).</li></ul></li>
<li>Or at least 2 other arguments are necessary:
<ul>
<li>'-to' option: specifies the remote Host Id (either the Id for SSL or not ).</li>
<li>'-id' option: specifies the Id of a previous transfer (stopped or in error).</li></ul></li>
<li>Other options are:
<ul>
<li>'-info' option: specifies the optional information that is send at the same time with the transfer request (extra information that could be needed by the remote host).</li>
<li>'-md5' option: specifies that each block transfer will be checked with a MD5 key. If the rule used is already in MD5 mode, this option will change nothing.</li>
<li>'-block' option: specifies the block size (default is 64 KB).</li>
<li>'-nolog' option: specifies that this transfer will not be logged (only on requester side).
<ul>
<li>'-start' &quot;time start&quot; as yyyyMMddHHmmss (override previous -delay options)</li></ul></li>
<li>'-delay' &quot;+delay in ms&quot; as delay in ms from current time(override previous -start options)
<ul>
<li>'-delay' &quot;delay in ms&quot; as time in ms (override previous -start options)</li></ul></li></ul></li></ul></section><section>
<h4><a name="DirectTransfer"></a>DirectTransfer</h4>
<p>This is the second method to transfer a file. This method is direct, so as a synchronous operation. This time the client will do the real work (transferring the file). The options are exactly the same than with SubmitTransfer. However two cases exist:</p>
<ul>
<li>Heavy client: The client XML configuration file includes the database access. All transfer operations will be logged (eventually deleted at the end from the client side if the '-nolog' option is set). This option is useful for &quot;production&quot; clients in a data center.</li>
<li>Light client: The client XML configuration file does not included the database access. All transfer operations will not be logged at all (at client side). This option is useful for &quot;light client&quot; like personal computers where transferring files to or from a data center is a necessity.
<p>However, both clients can only be the initiator of the transfer (receive or send), since no service is running once the client is over.</p></li></ul></section><section>
<h4><a name="SendThroughClient"></a>SendThroughClient</h4>
<p>This method is not a full implemented method. It is a way to route a file transfer from one protocol in Java to OpenR66. For instance, if a protocol like HTTP upload or FTP upload allows to get a file upload by packet, you can then route this file transfer through OpenR66 to a final OpenR66 Server using the protocol but without writing an intermediary file (directly write the bytes from the upload to the OpenR66 SendThroughClient interface). A simple example is shown in TestSendThroughClient.</p>
<p>So this method needs some minor developments to be implemented.</p></section><section>
<h4><a name="RecvThroughClient"></a>RecvThroughClient</h4>
<p>This method is not a full implemented method. It is a way to route a file transfer to one protocol in Java to OpenR66. For instance, if a protocol like HTTP or FTP download allows to get a file downloaded by packet, you can then route directly the file transfer from OpenR66 from a remote OpenR66 Server using the protocol directly but without writing an intermediary file (directly write the bytes from the download from the OpenR66 RecvThroughHandler interface). A simple example is shown in TestRecvThroughClient.</p>
<p>So this method needs some minor developments to be implemented.</p></section><section>
<h4><a name="ProgressBarTransfer"></a>ProgressBarTransfer</h4>
<p>This method is not a full implemented method. It is a way to implement a file transfer within a Graphical User Interface or to get information on progression during the transfer. Such an example is presented in the R66GUI.</p>
<p>So this method needs some minor developments to be implemented.</p></section><section>
<h4><a name="RequestTransfer"></a>RequestTransfer</h4>
<p>This utility is used to get information for a specific runner or to have an action on this runner.</p>
<p>The arguments are the following:</p>
<ul>
<li>The first argument is the client XML configuration file including the database access.</li>
<li>'-id' option: this is the Runner Id.</li>
<li>'-to' or '-from' option (exclusive): this specifies the way of the request transfer. '-to' specifies that the original request was initiated by the current running host to the remote specified host. '-from' specifies that the original request was initiated by the remote specified host.</li>
<li>Optional arguments (exclusive): without any of those arguments, the request only returns the current information of the runner.
<ul>
<li>'-cancel' option: the runner will be canceled. Any file currently in writing will be deleted.</li>
<li>'-stop' option: the runner will be stopped (but not canceled).</li>
<li>'-restart' option: the runner will be restart (if stopped).</li></ul></li></ul></section><section>
<h4><a name="RequestInformation"></a>RequestInformation</h4>
<p>This utility is used to get information for a file, a directory, with or without wildcard characters ('*' and '?&quot;).</p>
<p>The arguments are the following:</p>
<ul>
<li>The first argument is the client XML configuration file including the database access.</li>
<li>'-to' option: specifies the requested host.</li>
<li>'-rule' option: the rule</li>
<li>'-file' the optional file for which to get info (may contain wildcard characters)</li>
<li>Optional arguments (exclusive): without any of those arguments, the request only returns the existence of the file or directory.
<ul>
<li>'-exist' to test the existence.</li>
<li>'-detail' to get the detail on file.</li>
<li>'-list' to get the list of files.</li>
<li>'-mlsx' to get the list and details of files</li></ul></li></ul></section><section>
<h4><a name="Message"></a>Message</h4>
<p>This utility is used to send a short message to another server (like a ping in OpenR66 protocol)</p>
<p>The arguments are the following:</p>
<ul>
<li>The first argument is the client XML configuration file</li>
<li>'-to' option: specifies the requested host.</li>
<li>'-msg' option: the msg to send</li></ul></section></section></section>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        Copyright &#169;      2009&#x2013;2020<a href="http://www.waarp.fr">Waarp</a>.
.      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
